"use strict";(self.webpackChunkbattleship=self.webpackChunkbattleship||[]).push([[304],{895:(t,e,s)=>{s.d(e,{Z:()=>n});const n=function(t){const e=t.replace(/[^0-9||,]*/g,"").split(",");return[Number(e[0]),Number(e[1])]}},559:(t,e,s)=>{s.d(e,{Z:()=>i});var n=s(765);class i{constructor(){this.cells=this.#t(),this.ships=[]}#t(){const t=new Map;for(let e=0;e<10;e+=1)for(let s=0;s<10;s+=1)t.set(`[${e},${s}]`,"empty");return t}#e(t){return"empty"===this.cells.get(t)}checkIfPositionsAvailable(t){return t.getPositions().every(this.#e.bind(this))}addShip(t,e,s){if("empty"===this.cells.get(t)){const i=new n.Z(t,e,s);if(this.checkIfPositionsAvailable(i))return this.ships.push(i),i.getPositions().forEach((t=>{this.cells.set(t,"ship")})),!0}return!1}getCells(){return this.cells}receiveAttack(t){let e=!1;return this.ships.forEach((s=>{s.hit(t)&&(e=!0)})),e?(this.cells.set(t,"hit"),!0):(this.cells.set(t,"miss"),!1)}allShipsSunk(){return this.ships.every((t=>t.isSunk()))}setShips(t){const e=[];t.forEach((t=>{e.push(t),t.getPositions().forEach((t=>{this.cells.set(t,"ship")}))})),this.ships=e}}},291:(t,e,s)=>{s.d(e,{P:()=>r,y:()=>a});var n=s(765),i=s(559);function o(t){const e=[];return t.forEach(((t,s)=>{e.push({cell:s,value:t})})),e}function r(t,e){return e instanceof n.Z?{datatype:"Ship",hits:e.hits,positions:o(e.positions)}:e instanceof Map?o(e):e}function a(t,e){if("object"==typeof e&&null!==e){if("Ship"===e.datatype)return function(t){const{hits:e}=t,{positions:s}=t,i=new Map;s.forEach((t=>{i.set(t.cell,t.value)}));const o=new n.Z("[0,0]",0,"vertical");return o.positions=i,o.hits=e,o}(e);if(e.ships)return function(t){const{cells:e}=t,{ships:s}=t,n=new Map;e.forEach((t=>{n.set(t.cell,t.value)}));const o=new i.Z;return o.cells=n,o.ships=s,o}(e)}return e}},765:(t,e,s)=>{s.d(e,{Z:()=>i});var n=s(895);class i{constructor(t,e,s){this.positions=this.#s(t,e,s),this.hits=0}#s(t,e,s){const[i,o]=(0,n.Z)(t),r=new Map;if("vertical"===s)for(let t=0;t<e;t+=1)r.set(`[${i},${o+t}]`,!1);else if("horizontal"===s)for(let t=0;t<e;t+=1)r.set(`[${i+t},${o}]`,!1);return r}getPositions(){const t=[];return this.positions.forEach(((e,s)=>{t.push(s)})),t}getLength(){return this.getPositions().length}hit(t){if(void 0!==this.positions.get(t)&&!0!==this.positions.get(t)){const[e,s]=(0,n.Z)(t);return this.positions.set(`[${e},${s}]`,!0),this.hits+=1,!0}return!1}isSunk(){return this.hits>=this.getLength()}}},200:(t,e,s)=>{function n(t,e){const s=document.createElement("div");return s.classList.add("cell"),s.setAttribute("data-id",`[${t},${e}]`),s}function i(){Array.from(document.querySelectorAll(".shipButton")).forEach((t=>{t.classList.remove("selected")}))}function o(t){return t.classList.contains("carrier")?"carrier":t.classList.contains("battleship")?"battleship":t.classList.contains("submarine")?"submarine":t.classList.contains("lightCruiser")?"lightCruiser":t.classList.contains("heavyCruiser")?"heavyCruiser":void 0}function r(){const t=document.querySelectorAll(".shipButton");return!!Array.from(t).every((t=>t.disabled))&&(document.getElementById("next").disabled=!1,!0)}function a(t){const e=document.getElementById("errorMessage");e.textContent=t,e.classList.add("showError")}var c=s(559),l=s(765),h=s(291);function d(t){const e=[];return t.forEach(((t,s)=>{"empty"===t&&e.push(s)})),e[Math.floor(Math.random()*e.length)]}const u=function(t){const e=[];return Array.from(t).forEach((t=>{const s=t.dataset.length;e.push(s)})),function(t){const e=new c.Z,s=function(t){const e=t;let s,n=e.length;for(;n>0;)s=Math.floor(Math.random()*n),n-=1,[e[n],e[s]]=[e[s],e[n]];return e}(t);return s.forEach((t=>{const s=function(t,e){for(;;){const s=d(e.getCells()),n=new l.Z(s,t,"vertical"),i=new l.Z(s,t,"horizontal");if(e.checkIfPositionsAvailable(n))return{coordinate:s,orientation:"vertical",lenght:t};if(e.checkIfPositionsAvailable(i))return{coordinate:s,orientation:"horizontal",lenght:t}}}(t,e);e.addShip(s.coordinate,s.lenght,s.orientation)})),e}(e)};let g=new c.Z,m=new Map,p="";const f=new Map;function v(t){const e=t.target.dataset.id;if(null!==sessionStorage.getItem("shipLength")){const t=function(t){const e=sessionStorage.getItem("shipLength"),s=sessionStorage.getItem("shipOrientation");return g.addShip(t,e,s)?g.ships[g.ships.length-1]:null}(e);if(t){const e=sessionStorage.getItem("shipId");m.set(e,t),s=e,function(t){const e=document.querySelectorAll(`.${t}`),s=Array.from(e);s[1].disabled=!0,s[0].disabled=!0}(o(document.getElementById(s))),i(),r(),function(t,e){t.forEach((t=>{e.get(t).classList.add("ship")}))}(t.getPositions(),f),document.getElementById("errorMessage").classList.remove("showError"),sessionStorage.removeItem("shipLength")}else a("Elija otra posicion para el barco")}else r||a("Debe escoger un barco primero");var s}function E(t){const e=function(t){const e=sessionStorage.getItem("shipLength"),s=sessionStorage.getItem("shipOrientation"),n=new l.Z(t,e,s);return g.checkIfPositionsAvailable(n)?{possibleShip:n,status:!0}:{possibleShip:n,status:!1}}(t.target.dataset.id);f.forEach((t=>{t.classList.remove("hover","valid","invalid")})),e.status?e.possibleShip.getPositions().forEach((t=>{f.get(t).classList.add("hover","valid")})):e.possibleShip.getPositions().forEach((t=>{const e=f.get(t);void 0!==e&&e.classList.add("hover","invalid")}))}const y=document.getElementById("ready"),S=document.getElementById("board"),I=document.getElementById("reset"),L=document.getElementById("next");!function(t,e){for(let t=9;t>=0;t-=1)for(let s=0;s<10;s+=1)!0===e.test?e.appendChild():e.appendChild(n(s,t))}(0,S);const b=S.querySelectorAll(".cell"),w=document.getElementById("vertical"),A=document.getElementById("horizontal"),B=document.getElementById("horizontalM"),k=document.getElementById("verticalM"),C=document.getElementById("carrier"),P=new Event("click");A.addEventListener("change",(()=>{sessionStorage.setItem("shipOrientation","horizontal")})),w.addEventListener("change",(()=>{sessionStorage.setItem("shipOrientation","vertical")})),B.addEventListener("change",(()=>{sessionStorage.setItem("shipOrientation","horizontal")})),k.addEventListener("change",(()=>{sessionStorage.setItem("shipOrientation","vertical")})),Array.from(b).forEach((t=>{t.addEventListener("click",v),t.addEventListener("mouseover",E),t.addEventListener("touchstart",E),f.set(t.dataset.id,t)})),y.addEventListener("click",(()=>{document.getElementById("curtain").classList.add("closed")})),I.addEventListener("click",(function(){m=new Map,g=new c.Z,f.forEach((t=>{t.classList.remove("ship")})),function(){const t=document.querySelectorAll(".shipButton");document.getElementById("next").disabled=!0,Array.from(t).forEach((t=>{t.disabled=!1}))}()})),S.addEventListener("mouseout",(function(){f.forEach((t=>{t.classList.remove("hover","valid","invalid")}))})),L.addEventListener("click",(()=>{g.setShips(m);const t=JSON.stringify(g,h.P),e=sessionStorage.getItem("current");sessionStorage.setItem(`${e}Gameboard`,t),window.location.href=p})),Array.from(document.querySelectorAll(".shipButton")).forEach((t=>{t.addEventListener("click",(e=>{!function(t){const{length:e}=t.target.closest("[data-length]").dataset,{id:s}=t.target.closest("[data-length]");sessionStorage.setItem("shipLength",`${e}`),sessionStorage.setItem("shipId",`${s}`)}(e),function(t){i(),function(t){const e=o(t),s=document.querySelectorAll(`.${e}`),n=Array.from(s);n[1].classList.add("selected"),n[0].classList.add("selected")}(t)}(t)}))})),sessionStorage.setItem("current",sessionStorage.getItem("setup")),function(){const t=document.getElementById("playerName"),e=document.getElementById("name"),s=JSON.parse(sessionStorage.getItem(sessionStorage.getItem("current")));t.textContent=s.name,e.textContent=s.name}(),"player1"===sessionStorage.getItem("current")?(sessionStorage.setItem("setup","player2"),p="shipSetup.html"):p="board.html",sessionStorage.setItem("shipOrientation","horizontal"),sessionStorage.removeItem("shipLength"),function(){const t=sessionStorage.getItem("current"),{isComputer:e}=JSON.parse(sessionStorage.getItem(t)),s=document.getElementById("shipList").querySelectorAll("button");if(e){g=u(s);const t=JSON.stringify(g,h.P),e=sessionStorage.getItem("current");sessionStorage.setItem(`${e}Gameboard`,t),window.location.href=p}}(),C.dispatchEvent(P)}},t=>{t(t.s=200)}]);
//# sourceMappingURL=shipSetup.bundle.js.map